<?xml version="1.0" encoding="UTF-8"?>
<configuration-core xmlns="http://rtfm.essembeh.org/ConfigurationCore-v1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<!-- File types -->
	<filehandlers>
		<filehandler id="MP3">
			<conditions>
				<virtualpath matches="/[^/]+/[^/]+/\d\d - .*\.mp3" />
			</conditions>
			<attributes>
				<attribute name="rtfm:tagged" value="false" />
				<attribute name="db:export" value="true" />
				<attribute name="tag:comment" value="Tagged with RegexTagForMusic" />
				<regex-attribute name="tag:artist" pattern="/(.*)/(?:([12]\d\d\d) - )?(.*)/(\d{2,3}) - (.*)\.\w+" group="1" />
				<regex-attribute name="tag:year" pattern="/(.*)/(?:([12]\d\d\d) - )?(.*)/(\d{2,3}) - (.*)\.\w+" group="2" optional="true" />
				<regex-attribute name="tag:album" pattern="/(.*)/(?:([12]\d\d\d) - )?(.*)/(\d{2,3}) - (.*)\.\w+" group="3" />
				<regex-attribute name="tag:track" pattern="/(.*)/(?:([12]\d\d\d) - )?(.*)/(\d{2,3}) - (.*)\.\w+" group="4" />
				<regex-attribute name="tag:title" pattern="/(.*)/(?:([12]\d\d\d) - )?(.*)/(\d{2,3}) - (.*)\.\w+" group="5" />
			</attributes>
		</filehandler>
		<filehandler id="COVER">
			<conditions>
				<virtualpath matches="/[^/]+/[^/]+/cover\.(jpg|jpeg|png)" />
			</conditions>
			<attributes>
				<attribute name="db:export" value="false" />
			</attributes>
		</filehandler>
		<filehandler id="PLAYLIST">
			<conditions>
				<virtualpath matches="/[^/]+/[^/]+/playlist\.m3u" />
			</conditions>
			<attributes>
				<attribute name="db:export" value="false" />
			</attributes>
		</filehandler>
		<filehandler id="FOLDER">
			<conditions>
				<virtualpath matches=".*/" />
			</conditions>
			<attributes>
				<attribute name="ignore" value="" />
			</attributes>
		</filehandler>
		<filehandler id="UNKNOWN">
			<conditions>
				<virtualpath matches=".*" />
			</conditions>
			<attributes>
				<attribute name="db:export" value="false" />
			</attributes>
		</filehandler>
	</filehandlers>
	<!-- Tasks -->
	<tasks>
		<task id="setNonTagged" classname="org.essembeh.rtfm.tasks.UpdateAttributes">
			<property name="rtfm:tagged" value="false" />
		</task>
		<task id="setTagged" classname="org.essembeh.rtfm.tasks.UpdateAttributes">
			<property name="rtfm:tagged" value="true" />
		</task>
		<task id="JAudioTagger-id3v2.4" classname="org.essembeh.rtfm.tasks.JAudioTagger">
			<property name="version" value="ID3V2_4" />
		</task>
		<task id="JAudioTagger-id3v2.3" classname="org.essembeh.rtfm.tasks.JAudioTagger">
			<property name="version" value="ID3V2_3" />
		</task>
	</tasks>
	<actions>
		<action id="Tag ID3v2.4" description="Tag with JAudioTagger and ID3v2.4">
			<apply-on>
				<filehandler ref-id="MP3" />
			</apply-on>
			<workflow>
				<task ref-id="JAudioTagger-id3v2.4" />
			</workflow>
		</action>
		<action id="Tag ID3v2.3" description="Tag with JAudioTagger and ID3v2.3">
			<apply-on>
				<filehandler ref-id="MP3" />
			</apply-on>
			<workflow>
				<task ref-id="JAudioTagger-id3v2.3" />
			</workflow>
		</action>
	</actions>
</configuration-core>